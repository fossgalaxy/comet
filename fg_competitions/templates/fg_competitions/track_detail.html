{% extends "base.html" %}
{% load account %}

{% block head_title %}{{competition}}{% endblock %}

{% block content %}
{% if track.allow_submit and user.is_authenticated %}
{% if not submission %}
<p class="pull-right"><a class="btn btn-primary" href="{% url 'submission_create' track=track.pk %}">Create Submission</a></p>
{% else %}
<p class="pull-right"><a class="btn btn-primary" href="{{submission.get_absolute_url}}">View Submission</a></p>
{% endif %}
{% endif %}

<h1>{{track.competition}} <small>{{track}}</small></h1>
{% if track.owner %}
<p> Run by <a href="{{track.owner.get_absolute_url}}">{{track.owner}}</a></p>
{% endif %}

<p class="lead">{{track.description}}</p>

<ul class="list-unstyled">
<li>{% if track.allow_submit %}<p><i class="fa fa-check" aria-hidden="true"></i>
 Submissions Open</p>{% else %}<p><i class="fa fa-times" aria-hidden="true"></i>
 Submissions closed</p>{% endif %}</li>
<li>{% if track.allow_update %}<p><i class="fa fa-check" aria-hidden="true"></i>
 Editing of existing submissions allowed</p>{% else %}<p><i class="fa fa-times" aria-hidden="true"></i>
Editing of existing submissions not allowed</p>{% endif %}</li>
</ul>

<h2>Submissions</h2>
<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Owner</th>
      <th>Ranking</th>
    </tr>
  </thead>

<tbody>
{% for submission in track.submission_set.all %}
  <tr>
    <th><a href="{{submission.get_absolute_url}}">{{submission}}</a></th>
    <td>{% user_display submission.owner %}</td>
    <td>{{submission.ranking}}</td>
  </tr>
  {% empty %}
  <tr>
    <td colspan="3"><p class="text-center">There are presently no submissions</p></td>
  </tr>
{% endfor %}
</tbody>
</table>

{% endblock %}
